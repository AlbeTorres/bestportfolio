---
import { getCollection } from 'astro:content'
import Blogpost from '../../components/Blogpost.astro'
import Layout from '../../layouts/Layout.astro'
import { slugify } from '../../utils/functions'

const filteredPosts = await getCollection('posts', p => {
  if (p.data.draft !== true && new Date(p.data.date) < new Date()) {
    return p
  }
})
---

<Layout
  title='Alberto Torres ğŸ‘¨â€ğŸ’»| Software Engineer'
  description="Hello there! I'm Alberto Torres ğŸ‘‹ A passionate freelance fullstack software engineer based in Miami. With over three years of experience."
>
  <main>
    <h1 class='text-3xl font-bold my-5'>Blog:</h1>
    <div class='w-full'>
      {
        filteredPosts.map(p => (
          <Blogpost
            title={p.data.title}
            image={p.data.image}
            url={slugify(p.data.title)}
            description={p.data.description}
            tags={p.data.tags}
            author={p.data.author}
            date={p.data.date}
            draft={p.data.draft}
          />
        ))
      }
    </div>
  </main>
</Layout>
